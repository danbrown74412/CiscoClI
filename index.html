<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>CISCO CLI ACADEMY</title>
<style>
@import url('https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@300;400;500;600;700&family=Orbitron:wght@400;500;600;700;800;900&family=Inter:wght@300;400;500;600;700&display=swap');
:root{--bg:#0a0e14;--bg2:#111922;--bg3:#151f2b;--bg4:#1a2636;--cy:#00e5ff;--cy2:#00a5b8;--gn:#00ff88;--gn2:#00b85c;--or:#ff9100;--rd:#ff3d3d;--pu:#b388ff;--yl:#ffd740;--gd:#ffc107;--tx:#e0e6ed;--txd:#7a8a9e;--br:#1e2d3d}
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:'Inter',sans-serif;background:var(--bg);color:var(--tx);min-height:100vh;overflow-x:hidden}
body::after{content:'';position:fixed;top:0;left:0;right:0;bottom:0;background:repeating-linear-gradient(0deg,transparent,transparent 2px,rgba(0,229,255,0.015) 2px,rgba(0,229,255,0.015) 4px);pointer-events:none;z-index:9999}
::-webkit-scrollbar{width:6px}::-webkit-scrollbar-track{background:var(--bg)}::-webkit-scrollbar-thumb{background:var(--cy2);border-radius:3px}
@keyframes glowPulse{0%,100%{box-shadow:0 0 5px rgba(0,229,255,0.3)}50%{box-shadow:0 0 20px rgba(0,229,255,0.6)}}
@keyframes slideUp{from{opacity:0;transform:translateY(30px)}to{opacity:1;transform:translateY(0)}}
@keyframes fadeIn{from{opacity:0}to{opacity:1}}
@keyframes blink{50%{opacity:0}}
@keyframes floatUp{0%{opacity:1;transform:translateY(0) scale(1)}100%{opacity:0;transform:translateY(-80px) scale(1.5)}}
@keyframes streakFire{0%,100%{text-shadow:0 0 10px #ff9100}50%{text-shadow:0 0 25px #ff3d3d,0 0 50px #ff9100}}
@keyframes correctFlash{0%{background:rgba(0,255,136,0.3)}100%{background:transparent}}
@keyframes wrongFlash{0%{background:rgba(255,61,61,0.3)}100%{background:transparent}}
.asu{animation:slideUp .4s ease-out}.afi{animation:fadeIn .3s ease-out}
.top-bar{display:flex;align-items:center;justify-content:space-between;padding:12px 24px;background:var(--bg2);border-bottom:1px solid var(--br);position:sticky;top:0;z-index:100}
.app-logo{font-family:'Orbitron';font-size:18px;font-weight:800;background:linear-gradient(135deg,var(--cy),var(--gn));-webkit-background-clip:text;-webkit-text-fill-color:transparent;letter-spacing:2px}
.rank-badge{background:var(--bg3);border:1px solid var(--cy2);padding:4px 12px;border-radius:4px;font-family:'JetBrains Mono';font-size:11px;color:var(--cy);text-transform:uppercase;letter-spacing:1px}
.sc{display:flex;align-items:center;gap:6px;font-family:'JetBrains Mono';font-size:13px}
.sc .l{color:var(--txd);font-size:10px;text-transform:uppercase;letter-spacing:1px}.sc .v{font-weight:600}
.xbw{width:200px;height:8px;background:var(--bg);border-radius:4px;overflow:hidden;border:1px solid var(--br)}
.xbf{height:100%;background:linear-gradient(90deg,var(--cy),var(--gn));border-radius:4px;transition:width .6s}
.nav-tabs{display:flex;gap:4px;padding:8px 24px;background:var(--bg2);border-bottom:1px solid var(--br);flex-wrap:wrap}
.nav-tab{padding:10px 20px;background:0;border:none;color:var(--txd);font-family:'Inter';font-size:13px;font-weight:500;cursor:pointer;border-radius:6px;transition:all .2s;display:flex;align-items:center;gap:8px}
.nav-tab:hover{background:var(--bg4);color:var(--tx)}.nav-tab.active{background:var(--bg3);color:var(--cy);border:1px solid var(--br)}
.main-content{padding:24px;max-width:1400px;margin:0 auto}
.screen{display:none}.screen.active{display:block;animation:fadeIn .3s ease}
.dg{display:grid;grid-template-columns:1fr 1fr 1fr;gap:20px;margin-bottom:24px}
.dc{background:var(--bg3);border:1px solid var(--br);border-radius:10px;padding:24px;transition:all .3s}
.dc:hover{border-color:var(--cy2)}
.dc h3{font-family:'Orbitron';font-size:12px;color:var(--txd);text-transform:uppercase;letter-spacing:2px;margin-bottom:12px}
.dc .bn{font-family:'Orbitron';font-size:36px;font-weight:700}.dc .st{font-size:13px;color:var(--txd);margin-top:4px}
.dc.fw{grid-column:1/-1}
.mc{display:flex;align-items:center;gap:20px;background:var(--bg3);border:1px solid var(--br);border-radius:10px;padding:20px 24px;cursor:pointer;transition:all .3s;margin-bottom:12px}
.mc:hover{border-color:var(--cy2);transform:translateX(4px)}
.mc.locked{opacity:.5;cursor:not-allowed}.mc.locked:hover{transform:none;border-color:var(--br)}
.mc.completed{border-left:3px solid var(--gn)}.mc.current{border-left:3px solid var(--cy);animation:glowPulse 3s infinite}
.mn{width:50px;height:50px;display:flex;align-items:center;justify-content:center;border-radius:50%;font-family:'Orbitron';font-size:18px;font-weight:700;flex-shrink:0}
.mc.completed .mn{background:var(--gn);color:var(--bg)}.mc.current .mn{background:var(--cy);color:var(--bg)}
.mc.locked .mn{background:var(--bg);color:var(--txd);border:2px solid var(--br)}
.mc:not(.locked):not(.completed):not(.current) .mn{background:var(--bg);color:var(--tx);border:2px solid var(--txd)}
.lh{background:var(--bg3);border:1px solid var(--br);border-radius:10px;padding:24px;margin-bottom:20px}
.lh h2{font-family:'Orbitron';font-size:20px;margin-bottom:8px}
.lpb{flex:1;height:8px;background:var(--bg);border-radius:4px;overflow:hidden}.lpf{height:100%;background:linear-gradient(90deg,var(--cy),var(--gn));border-radius:4px;transition:width .5s}
.lcnt{background:var(--bg3);border:1px solid var(--br);border-radius:10px;padding:32px;margin-bottom:20px;animation:slideUp .4s ease}
.lcnt h3{font-family:'Orbitron';font-size:16px;color:var(--cy);margin-bottom:16px}.lcnt p{line-height:1.7;margin-bottom:12px;font-size:15px}
.cli{background:#000;border:1px solid #333;border-radius:8px;padding:16px 20px;font-family:'JetBrains Mono';font-size:14px;color:var(--gn);margin:16px 0;overflow-x:auto;white-space:pre-wrap}
.cli .p{color:var(--cy)}.cli .c{color:#666;font-style:italic}.cli .k{color:var(--or)}.cli .o{color:#999}
.kp{background:rgba(0,229,255,0.05);border-left:3px solid var(--cy);padding:12px 16px;margin:16px 0;border-radius:0 6px 6px 0;font-size:14px;line-height:1.6}
.wb{background:rgba(255,61,61,0.05);border-left:3px solid var(--rd);padding:12px 16px;margin:16px 0;border-radius:0 6px 6px 0;font-size:14px;line-height:1.6}
.pt{background:rgba(255,215,64,0.05);border-left:3px solid var(--gd);padding:12px 16px;margin:16px 0;border-radius:0 6px 6px 0;font-size:14px;line-height:1.6}
.qo{display:flex;flex-direction:column;gap:10px}
.qopt{display:flex;align-items:center;gap:12px;background:var(--bg3);border:2px solid var(--br);border-radius:10px;padding:16px 20px;cursor:pointer;transition:all .2s;font-size:15px}
.qopt:hover{border-color:var(--cy2);background:var(--bg4)}
.qopt .ok{width:32px;height:32px;display:flex;align-items:center;justify-content:center;background:var(--bg);border-radius:6px;font-family:'JetBrains Mono';font-size:13px;font-weight:600;color:var(--txd);flex-shrink:0}
.qopt.correct{border-color:var(--gn);background:rgba(0,255,136,.1);animation:correctFlash .5s}.qopt.correct .ok{background:var(--gn);color:var(--bg)}
.qopt.wrong{border-color:var(--rd);background:rgba(255,61,61,.1);animation:wrongFlash .5s}.qopt.wrong .ok{background:var(--rd);color:#fff}
.qopt.disabled{pointer-events:none;opacity:.6}
.tiw{display:flex;align-items:center;background:#000;border:2px solid var(--br);border-radius:8px;padding:4px;margin-top:12px;transition:border-color .3s}
.tiw:focus-within{border-color:var(--cy)}
.tip{font-family:'JetBrains Mono';color:var(--cy);padding:12px;font-size:14px;white-space:nowrap}
.tii{flex:1;background:0;border:none;color:var(--gn);font-family:'JetBrains Mono';font-size:14px;padding:12px 8px;outline:none}.tii::placeholder{color:#444}
.btn{padding:12px 24px;border:none;border-radius:8px;font-family:'Inter';font-size:14px;font-weight:600;cursor:pointer;transition:all .2s;display:inline-flex;align-items:center;gap:8px}
.bp{background:var(--cy);color:var(--bg)}.bp:hover{background:#33ebff;transform:translateY(-1px);box-shadow:0 4px 15px rgba(0,229,255,.3)}
.bs{background:var(--bg3);color:var(--tx);border:1px solid var(--br)}.bs:hover{border-color:var(--cy2)}
.bd{background:rgba(255,61,61,.15);color:var(--rd);border:1px solid rgba(255,61,61,.3)}.bd:hover{background:rgba(255,61,61,.25)}
.bg{background:var(--gn);color:var(--bg)}.bg:hover{background:#33ff99}
.bsm{padding:8px 16px;font-size:12px}.blg{padding:16px 32px;font-size:16px}
.xp-float{position:fixed;font-family:'Orbitron';font-size:20px;font-weight:700;color:var(--cy);pointer-events:none;z-index:1000;animation:floatUp 1.5s ease forwards}
.mo{position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,.8);display:flex;align-items:center;justify-content:center;z-index:500;animation:fadeIn .3s}.mo.hidden{display:none}
.modal{background:var(--bg2);border:1px solid var(--cy2);border-radius:16px;padding:40px;text-align:center;max-width:500px;width:90%;animation:slideUp .4s}
.rsg{display:grid;grid-template-columns:repeat(auto-fill,minmax(350px,1fr));gap:12px}
.rc{background:var(--bg3);border:1px solid var(--br);border-radius:8px;padding:16px;transition:all .2s}.rc:hover{border-color:var(--cy2)}
.rcm{font-family:'JetBrains Mono';font-size:14px;color:var(--gn);margin-bottom:6px}
.rcd{font-size:13px;color:var(--txd);line-height:1.4}
.rcat{display:inline-block;font-size:10px;text-transform:uppercase;letter-spacing:1px;padding:2px 8px;border-radius:3px;margin-top:8px}
.ag{display:grid;grid-template-columns:repeat(auto-fill,minmax(280px,1fr));gap:16px}
.ac{background:var(--bg3);border:1px solid var(--br);border-radius:10px;padding:20px;display:flex;align-items:center;gap:16px;transition:all .3s}
.ac.earned{border-color:var(--gd)}.ac.locked{opacity:.4}
.ai2{font-size:36px;width:60px;height:60px;display:flex;align-items:center;justify-content:center;background:var(--bg);border-radius:10px;flex-shrink:0}
.ac.earned .ai2{background:rgba(255,193,7,.15)}
.sb{background:var(--bg3);border:1px solid var(--br);border-radius:10px;padding:24px;margin-bottom:20px}
.sb h3{color:var(--rd);font-family:'Orbitron';font-size:14px;margin-bottom:12px}
.sb .to{background:#000;border:1px solid #333;padding:16px;border-radius:8px;font-family:'JetBrains Mono';font-size:13px;color:#ccc;white-space:pre-wrap;margin-top:12px}
.ss{background:var(--bg3);border:1px solid var(--br);border-radius:10px;padding:24px;margin-bottom:16px}
.ss h3{font-family:'Orbitron';font-size:13px;color:var(--txd);text-transform:uppercase;letter-spacing:2px;margin-bottom:16px}
.rp{max-width:600px;margin:0 auto;text-align:center}
.rp .scr{width:150px;height:150px;border-radius:50%;display:flex;flex-direction:column;align-items:center;justify-content:center;margin:24px auto;font-family:'Orbitron'}
.rp .scr .pc{font-size:36px;font-weight:700}.rp .scr .lb{font-size:11px;color:var(--txd);margin-top:4px}
.rp .sr{display:flex;justify-content:center;gap:32px;margin:20px 0}
.rp .si{text-align:center}.rp .si .va{font-family:'Orbitron';font-size:24px;font-weight:600}.rp .si .la{font-size:11px;color:var(--txd);margin-top:4px}
.md2{display:flex;gap:3px;margin-top:8px}.mdd{width:8px;height:8px;border-radius:50%;background:var(--bg);border:1px solid var(--br)}.mdd.f{background:var(--cy);border-color:var(--cy)}
.rfs{display:flex;gap:12px;margin-bottom:20px;flex-wrap:wrap;align-items:center}
.rfi{flex:1;min-width:200px;background:var(--bg3);border:2px solid var(--br);border-radius:8px;padding:12px 16px;color:var(--tx);font-family:'JetBrains Mono';font-size:14px;outline:none}.rfi:focus{border-color:var(--cy)}
.rfb{padding:10px 16px;background:var(--bg3);border:1px solid var(--br);border-radius:8px;color:var(--txd);cursor:pointer;font-size:13px;transition:all .2s}.rfb:hover,.rfb.active{border-color:var(--cy);color:var(--cy)}
.ws{display:flex;flex-direction:column;align-items:center;justify-content:center;min-height:80vh;text-align:center}
.wl{font-family:'Orbitron';font-size:48px;font-weight:900;background:linear-gradient(135deg,var(--cy),var(--gn));-webkit-background-clip:text;-webkit-text-fill-color:transparent;margin-bottom:8px}
.wt{background:#000;border:1px solid #333;border-radius:12px;padding:32px;max-width:500px;width:90%;text-align:left;font-family:'JetBrains Mono';font-size:14px;margin-bottom:32px}
.wt .ln{margin-bottom:8px}.wt .pr{color:var(--cy)}.wt .ty{color:var(--gn)}
.wt .cb{display:inline-block;width:8px;height:16px;background:var(--gn);animation:blink 1s step-end infinite;vertical-align:middle}
@media(max-width:900px){.dg{grid-template-columns:1fr}.top-bar{flex-wrap:wrap;gap:8px}.rsg{grid-template-columns:1fr}}
</style>
</head>
<body>

<div id="app">
<div id="ws" class="ws" style="display:none">
<div class="wl">CISCO CLI ACADEMY</div>
<div style="font-family:'JetBrains Mono';font-size:14px;color:var(--txd);margin-bottom:40px;letter-spacing:3px">COMMAND LINE COMBAT TRAINING</div>
<div class="wt">
<div class="ln"><span class="pr">system&gt;</span> <span class="ty">Initializing training protocol...</span></div>
<div class="ln"><span class="pr">system&gt;</span> <span class="ty">Loading command database... 79 commands indexed</span></div>
<div class="ln"><span class="pr">system&gt;</span> <span class="ty">66 campaign modules loaded. 123 lessons ready.</span></div>
<div class="ln"><span class="pr">system&gt;</span> <span class="ty">Recruit identified. Begin training?</span></div>
<div class="ln"><span class="pr">recruit&gt;</span> <span class="cb"></span></div>
</div>
<button class="btn bp blg" onclick="startNewGame()">&#x26A1; BEGIN TRAINING</button>
<p style="margin-top:16px;font-size:13px;color:var(--txd)">Progress saves automatically to your browser</p>
</div>
<div id="ma" style="display:none">
<div class="top-bar">
<div style="display:flex;align-items:center;gap:16px">
<div class="app-logo">CLI ACADEMY</div>
<div class="rank-badge" id="rb">CABLE MONKEY</div>
</div>
<div style="display:flex;align-items:center;gap:20px;flex:1;justify-content:center">
<div class="sc"><div><div class="l">Level</div><div class="v" style="color:var(--gd)" id="ld">1</div></div></div>
<div class="sc"><div><div class="l">XP</div><div class="v" style="color:var(--cy)"><span id="xd">0</span>/<span id="xn">100</span></div></div><div class="xbw"><div class="xbf" id="xb" style="width:0%"></div></div></div>
<div class="sc"><div><div class="l">Streak</div><div class="v" style="color:var(--or)" id="sd">0</div></div></div>
<div class="sc"><div><div class="l">Mastered</div><div class="v" style="color:var(--gn)" id="md">0</div></div></div>
</div>
<button class="btn bsm bs" onclick="showScreen('settings')">&#x2699;&#xFE0F;</button>
</div>
<div class="nav-tabs">
<button class="nav-tab active" data-screen="dashboard" onclick="showScreen('dashboard')">&#x1F4CA; Dashboard</button>
<button class="nav-tab" data-screen="campaign" onclick="showScreen('campaign')">&#x1F5FA;&#xFE0F; Campaign</button>
<button class="nav-tab" data-screen="reference" onclick="showScreen('reference')">&#x1F4D6; Reference</button>
<button class="nav-tab" data-screen="achievements" onclick="showScreen('achievements')">&#x1F3C6; Achievements</button>
</div>
<div class="main-content">
<div id="s-dashboard" class="screen active"></div>
<div id="s-campaign" class="screen"></div>
<div id="s-lesson" class="screen"></div>
<div id="s-reference" class="screen"></div>
<div id="s-achievements" class="screen"></div>
<div id="s-settings" class="screen"></div>
</div>
</div>
</div>
<div id="lm" class="mo hidden"><div class="modal"><div style="font-size:64px">&#x26A1;</div><h2 style="color:var(--gd);font-family:'Orbitron';font-size:28px">LEVEL UP!</h2><div id="lmc"></div><button class="btn bp" onclick="$('lm').classList.add('hidden')" style="margin-top:20px">Continue</button></div></div>

<script>
const MODULES=[{"id": "net101", "title": "Networking 101", "desc": "What is a network? Devices, topologies, and fundamentals.", "icon": "üåç", "tier": "Beginner", "lessons": [{"title": "What is a Network?", "content": "<h3>What is a Network?</h3>\n<p>A <strong>network</strong> is simply two or more devices connected together so they can share data. That's it. Your home WiFi? That's a network. Two computers connected by an Ethernet cable? Also a network. The entire internet? The biggest network ever built.</p>\n\n<p>Networks exist because standalone computers are limited. Imagine an office where nobody can email, share files, or use the internet ‚Äî that's a world without networks. Every modern business depends on them.</p>\n\n<h3>Types of Networks by Size</h3>\n<div class=\"cli\"><span class=\"k\">LAN</span>  - Local Area Network\n       A single building or floor. Your office, your home.\n       Fast (1-10 Gbps), cheap, you own/control it.\n       Uses Ethernet switches to connect devices.\n\n<span class=\"k\">WAN</span>  - Wide Area Network\n       Connects LANs across cities, countries, continents.\n       Slower than LAN, expensive (ISP circuits).\n       The internet is the world's largest WAN.\n\n<span class=\"k\">WLAN</span> - Wireless LAN\n       Same as LAN but uses WiFi (802.11) instead of cables.\n       Convenient but slower, less secure, shared medium.\n\n<span class=\"k\">MAN</span>  - Metropolitan Area Network\n       City-scale. Connects buildings across a campus or city.\n       Often fiber-based (Metro Ethernet).\n\n<span class=\"k\">SAN</span>  - Storage Area Network\n       Dedicated high-speed network just for storage (disk arrays).\n       Uses Fibre Channel or iSCSI. Servers access shared disks.\n\n<span class=\"k\">PAN</span>  - Personal Area Network\n       Your personal bubble: Bluetooth headphones, smartwatch.\n       Very short range (usually under 10 meters).</div>\n\n<h3>Network Devices ‚Äî What Does What?</h3>\n<p>Think of a network like a postal system. Devices play different roles:</p>\n<div class=\"cli\"><span class=\"k\">Hub</span>      Layer 1 ‚Äî A dumb repeater. Sends every packet to\n           EVERY port. Like shouting in a room. Obsolete.\n\n<span class=\"k\">Switch</span>   Layer 2 ‚Äî Smart. Learns which device is on which port\n           using MAC addresses. Sends packets ONLY to the right\n           port. This is the backbone of every modern LAN.\n\n<span class=\"k\">Router</span>   Layer 3 ‚Äî Connects DIFFERENT networks together using\n           IP addresses. Your home router connects your LAN to\n           your ISP's network. Without routers, networks are\n           isolated islands.\n\n<span class=\"k\">Firewall</span> Layer 3-7 ‚Äî Security guard. Inspects traffic and\n           blocks anything that violates the rules. Can filter\n           by IP, port, protocol, even application content.\n\n<span class=\"k\">L3 Switch</span> Combines switch + router. Routes between VLANs\n           at wire speed. Standard in enterprise networks.</div>\n\n<div class=\"kp\">üí° <strong>Key concept:</strong> Switches work with MAC addresses (Layer 2). Routers work with IP addresses (Layer 3). Understanding this distinction is fundamental to everything that follows.</div>", "questions": [{"type": "choice", "q": "Router connects?", "options": ["Devices on same network", "Different networks", "Only wireless", "Only WAN"], "answer": 1, "explain": "Routers connect different networks using IP."}, {"type": "choice", "q": "50 PCs on a switch = ?", "options": ["WAN", "LAN", "MAN", "SAN"], "answer": 1, "explain": "LAN = small local area."}, {"type": "choice", "q": "Switch forwards by?", "options": ["IP address", "MAC address", "Port number", "Hostname"], "answer": 1, "explain": "Switches use MAC tables."}, {"type": "choice", "q": "Two offices across a city connected = ?", "options": ["LAN", "WAN", "PAN", "VLAN"], "answer": 1, "explain": "WAN connects geographically distant sites."}]}, {"title": "The OSI Model", "content": "<h3>The OSI Model ‚Äî 7 Layers of Networking</h3>\n<p>The OSI model breaks networking into 7 layers. Each layer has a specific job and talks to the layers above and below it. When you send an email, your data travels DOWN through all 7 layers on your computer, across the wire, then UP through all 7 layers on the destination.</p>\n\n<p><strong>Why should you care?</strong> Because when something breaks, you troubleshoot layer by layer. \"Can't reach the server\" could be a Layer 1 problem (cable unplugged), Layer 2 (wrong VLAN), Layer 3 (bad route), or Layer 7 (service crashed). The OSI model is your troubleshooting framework.</p>\n\n<h3>The 7 Layers (memorize this!)</h3>\n<div class=\"cli\"><span class=\"k\">Mnemonic: All People Seem To Need Data Processing</span>\n(or from bottom: Please Do Not Throw Sausage Pizza Away)\n\n<span class=\"k\">Layer 7: Application</span>     What the USER sees\n   Protocols: HTTP, HTTPS, FTP, SSH, DNS, DHCP, SMTP\n   This is your web browser, email client, file transfer.\n   NOT the application itself ‚Äî the network SERVICES it uses.\n\n<span class=\"k\">Layer 6: Presentation</span>    Data FORMAT\n   Encryption (TLS/SSL), compression, character encoding.\n   Translates data between network and application format.\n\n<span class=\"k\">Layer 5: Session</span>         CONNECTION management\n   Establishes, maintains, terminates sessions.\n   Keeps your login session alive, manages dialog control.\n\n<span class=\"k\">Layer 4: Transport</span>       RELIABILITY\n   Protocols: TCP (reliable), UDP (fast)\n   Data unit: <strong>Segments</strong>\n   TCP: 3-way handshake, acknowledgments, retransmission.\n   UDP: Fire and forget. Used for voice, video, DNS queries.\n   Port numbers live here (80, 443, 22, etc.)\n\n<span class=\"k\">Layer 3: Network</span>         ROUTING between networks\n   Protocols: IP, ICMP, OSPF, EIGRP, BGP\n   Data unit: <strong>Packets</strong>\n   Devices: Routers, L3 switches\n   IP addresses, subnet masks, routing tables.\n   This is where routers make forwarding decisions.\n\n<span class=\"k\">Layer 2: Data Link</span>       LOCAL delivery\n   Protocols: Ethernet (802.3), WiFi (802.11)\n   Data unit: <strong>Frames</strong>\n   Devices: Switches, bridges\n   MAC addresses (burned into your NIC).\n   Switches build MAC tables to forward frames correctly.\n\n<span class=\"k\">Layer 1: Physical</span>        BITS on the wire\n   Cables, connectors, electrical signals, light pulses.\n   Data unit: <strong>Bits</strong> (1s and 0s)\n   Devices: Hubs, repeaters, cables\n   Cat5e/6 copper, fiber optic, wireless radio waves.</div>\n\n<div class=\"kp\">üí° <strong>Data encapsulation:</strong> As data goes DOWN the layers, each layer wraps it with a header. Layer 4 adds port numbers (segment), Layer 3 adds IP addresses (packet), Layer 2 adds MAC addresses (frame), Layer 1 converts to electrical signals (bits).</div>\n<div class=\"wb\">‚ö†Ô∏è On the exam: \"At which layer does a switch operate?\" = Layer 2. \"At which layer does a router operate?\" = Layer 3. These questions come up constantly.</div>", "questions": [{"type": "choice", "q": "Switches = Layer?", "options": ["1", "2", "3", "4"], "answer": 1, "explain": "Layer 2, MAC addresses."}, {"type": "choice", "q": "IP = Layer?", "options": ["2", "3", "4", "7"], "answer": 1, "explain": "Layer 3 Network."}, {"type": "choice", "q": "Data at Layer 2?", "options": ["Packet", "Segment", "Frame", "Bit"], "answer": 2, "explain": "L2=Frames."}, {"type": "choice", "q": "Router = Layer?", "options": ["1", "2", "3", "7"], "answer": 2, "explain": "Layer 3, IP routing."}, {"type": "choice", "q": "HTTP = Layer?", "options": ["4", "5", "6", "7"], "answer": 3, "explain": "Layer 7 Application."}, {"type": "choice", "q": "Data at Layer 4?", "options": ["Frame", "Packet", "Segment", "Bit"], "answer": 2, "explain": "L4=Segments."}]}, {"title": "Topologies & Devices", "content": "<h3>Network Topologies</h3>\n<p>A <strong>topology</strong> is the physical or logical layout of how devices connect. The topology you choose affects performance, cost, and what happens when something fails.</p>\n\n<div class=\"cli\"><span class=\"k\">Star Topology</span> ‚≠ê (Modern Standard)\n   Every device connects to a CENTRAL switch.\n   If one device fails, others are fine.\n   If the SWITCH fails, everything goes down.\n   This is what you see in every modern office.\n\n<span class=\"k\">Mesh Topology</span> üï∏Ô∏è (Redundant)\n   Every device connects to every other device.\n   Full mesh: N devices = N√ó(N-1)/2 links. Expensive!\n   Partial mesh: Key devices interconnected (common in WANs).\n   Maximum redundancy ‚Äî used between core switches/routers.\n\n<span class=\"k\">Bus Topology</span> (Legacy)\n   All devices share one cable (coaxial).\n   One break = entire network down.\n   Collisions everywhere. Obsolete since the 1990s.\n\n<span class=\"k\">Ring Topology</span> (Legacy)\n   Data travels in a circle. Each device passes to the next.\n   One break = network down (unless dual-ring).\n   Token Ring and FDDI used this. Essentially dead.</div>\n\n<p><strong>In practice:</strong> Modern networks use <strong>star topology at the access layer</strong> (devices to switches) and <strong>partial mesh at the core</strong> (switches to switches for redundancy). You'll never build a bus or ring network, but you need to know what they are for the exam.</p>\n\n<div class=\"kp\">üí° <strong>Real-world design:</strong> Enterprise networks follow a 3-tier model: Access (user switches) ‚Üí Distribution (aggregation) ‚Üí Core (high-speed backbone). Small sites collapse this to 2 tiers (Access + Core).</div>", "questions": [{"type": "choice", "q": "Modern LAN topology?", "options": ["Bus", "Ring", "Star", "Mesh"], "answer": 2, "explain": "Star with central switch."}, {"type": "choice", "q": "Hub = Layer?", "options": ["1", "2", "3", "4"], "answer": 0, "explain": "Layer 1, just repeats signals."}, {"type": "choice", "q": "Why hubs are bad?", "options": ["Expensive", "Broadcast to ALL ports", "Too fast", "No LEDs"], "answer": 1, "explain": "Hubs flood everything, wasting bandwidth and causing collisions."}, {"type": "choice", "q": "L3 switch combines?", "options": ["Firewall+VPN", "Switch+Router", "Hub+Bridge", "Server+NAS"], "answer": 1, "explain": "L3 switches do both switching and routing."}]}]}, {"id": "tcpip", "title": "TCP/IP & Ports", "desc": "TCP vs UDP, 3-way handshake, critical port numbers.", "icon": "üîó", "tier": "Beginner", "lessons": [{"title": "TCP vs UDP", "content": "<h3>TCP vs UDP ‚Äî Two Ways to Send Data</h3>\n<p>At Layer 4 (Transport), you have two choices for how data gets delivered. Understanding when to use each is fundamental to networking.</p>\n\n<h3>TCP ‚Äî Transmission Control Protocol</h3>\n<p>Think of TCP like <strong>certified mail with tracking</strong>. The sender knows exactly when the package arrives, and if it gets lost, it gets resent automatically.</p>\n<div class=\"cli\"><span class=\"k\">TCP Features:</span>\n‚úì Connection-oriented (3-way handshake BEFORE data flows)\n‚úì Reliable delivery (acknowledgments for every segment)\n‚úì Ordered (segments reassembled in correct order)\n‚úì Flow control (sender slows down if receiver overwhelmed)\n‚úì Error checking (checksums verify data integrity)\n\n<span class=\"k\">The 3-Way Handshake:</span>\n  Client ‚Üí Server:  SYN         \"I want to connect\"\n  Server ‚Üí Client:  SYN-ACK     \"OK, I acknowledge\"\n  Client ‚Üí Server:  ACK         \"Great, we're connected\"\n  ...data flows...\n\n<span class=\"k\">Connection Teardown (4-way):</span>\n  FIN ‚Üí ACK ‚Üí FIN ‚Üí ACK\n\n<span class=\"k\">TCP Services:</span> HTTP (80), HTTPS (443), SSH (22), FTP (20/21),\n              SMTP (25), Telnet (23), BGP (179)</div>\n\n<h3>UDP ‚Äî User Datagram Protocol</h3>\n<p>Think of UDP like <strong>dropping a letter in a mailbox</strong>. You have no idea if it arrives, and you don't care ‚Äî speed matters more than perfection.</p>\n<div class=\"cli\"><span class=\"k\">UDP Features:</span>\n‚úì Connectionless (no handshake ‚Äî just start sending)\n‚úì Unreliable (no acknowledgments, no retransmission)\n‚úì Unordered (packets may arrive out of order)\n‚úì Fast (no overhead from reliability mechanisms)\n‚úì Lightweight (8-byte header vs TCP's 20-byte header)\n\n<span class=\"k\">UDP Services:</span> DNS (53), DHCP (67/68), TFTP (69), SNMP (161),\n              Syslog (514), NTP (123), VoIP/RTP\n\n<span class=\"k\">Why UDP for voice/video?</span>\nA retransmitted voice packet arrives too late to be useful.\nBetter to drop it and keep going than pause and wait.</div>\n\n<div class=\"kp\">üí° <strong>DNS uses BOTH:</strong> UDP for normal queries (fast, small), TCP for zone transfers and responses over 512 bytes (reliable, large). This is a common exam question.</div>\n<div class=\"wb\">‚ö†Ô∏è Just because UDP is \"unreliable\" doesn't mean it's bad. Applications built on UDP (like VoIP) handle their own error correction at the application layer when needed.</div>", "questions": [{"type": "choice", "q": "Guaranteed delivery?", "options": ["UDP", "TCP", "ICMP", "ARP"], "answer": 1, "explain": "TCP with ACKs."}, {"type": "choice", "q": "VoIP uses?", "options": ["TCP", "UDP", "ICMP", "Both"], "answer": 1, "explain": "UDP, speed > perfection for voice."}, {"type": "choice", "q": "3-way handshake order?", "options": ["ACK,SYN,SYN-ACK", "SYN,SYN-ACK,ACK", "SYN,ACK,SYN-ACK", "FIN,ACK,RST"], "answer": 1, "explain": "SYN > SYN-ACK > ACK."}, {"type": "choice", "q": "DNS transport?", "options": ["TCP only", "UDP only", "Both TCP and UDP", "ICMP"], "answer": 2, "explain": "DNS uses UDP (queries) and TCP (zone transfers, large responses)."}, {"type": "choice", "q": "TCP teardown uses?", "options": ["RST only", "FIN/FIN-ACK", "SYN/SYN-ACK", "CLOSE"], "answer": 1, "explain": "Graceful: FIN, ACK, FIN, ACK (4-way)."}]}, {"title": "Port Numbers - Part 1", "content": "<h3>Well-Known Port Numbers (0-1023)</h3>\n<p><strong>Every network service listens on a specific port number.</strong> When your browser connects to a web server, it's really connecting to IP address + port 80 (HTTP) or 443 (HTTPS). Ports are like apartment numbers in a building ‚Äî the IP is the building address, the port is which door to knock on.</p>\n\n<p>You MUST memorize these. They show up in ACL rules, firewall configs, NAT translations, and troubleshooting every single day.</p>\n\n<div class=\"cli\"><span class=\"k\">Port  Proto  Service         What It Does</span>\n20    TCP    FTP Data        Actual file data transfers\n21    TCP    FTP Control     FTP commands (login, list, get)\n22    TCP    SSH             Encrypted remote access (ALWAYS use!)\n23    TCP    Telnet          Unencrypted remote access (NEVER use!)\n25    TCP    SMTP            Sending outbound email\n53    Both   DNS             Resolves names ‚Üí IP addresses\n                             UDP for queries, TCP for zone transfers\n67    UDP    DHCP Server     Server listens for client requests\n68    UDP    DHCP Client     Client listens for server responses\n69    UDP    TFTP            Simple file transfer (no authentication!)\n80    TCP    HTTP            Unencrypted web traffic</div>\n\n<h3>How Ports Work</h3>\n<p>A connection is identified by 4 things: <strong>Source IP + Source Port + Destination IP + Destination Port</strong>. When your PC visits google.com, it picks a random high port (like 52431) as the source and connects to Google's IP on destination port 443. This is how one server can handle thousands of connections simultaneously ‚Äî each has a unique source port.</p>\n\n<div class=\"cli\"><span class=\"k\">Port Ranges:</span>\n0-1023       Well-Known (assigned to standard services)\n1024-49151   Registered (applications can request these)\n49152-65535  Dynamic/Ephemeral (your PC picks from here)</div>\n\n<div class=\"wb\">‚ö†Ô∏è <strong>FTP uses TWO ports:</strong> 21 for commands, 20 for data. This causes problems with firewalls because the data connection is initiated separately. This is why SFTP (over SSH port 22) is preferred.</div>", "questions": [{"type": "choice", "q": "SSH port?", "options": ["21", "22", "23", "25"], "answer": 1, "explain": "SSH=22."}, {"type": "choice", "q": "FTP data port?", "options": ["20", "21", "22", "69"], "answer": 0, "explain": "FTP data=20, control=21."}, {"type": "choice", "q": "Telnet port?", "options": ["22", "23", "25", "80"], "answer": 1, "explain": "Telnet=23, plaintext!"}, {"type": "choice", "q": "DNS port?", "options": ["25", "53", "67", "80"], "answer": 1, "explain": "DNS=53."}, {"type": "choice", "q": "DHCP server port?", "options": ["53", "67", "68", "69"], "answer": 1, "explain": "Server=67, Client=68."}, {"type": "choice", "q": "TFTP port?", "options": ["20", "21", "22", "69"], "answer": 3, "explain": "TFTP=69, UDP, no auth."}]}, {"title": "Port Numbers - Part 2", "content": "<h3>More Critical Port Numbers</h3>\n<p>These ports are essential for email, monitoring, management, and security. Know them cold ‚Äî they appear in ACLs, firewall rules, and troubleshooting scenarios constantly.</p>\n\n<div class=\"cli\"><span class=\"k\">Port  Proto  Service         What It Does</span>\n110   TCP    POP3            Receive email (downloads to client)\n143   TCP    IMAP            Receive email (syncs, stays on server)\n161   UDP    SNMP            Monitoring: YOU poll the device\n162   UDP    SNMP Traps      Monitoring: DEVICE alerts you\n389   TCP    LDAP            Directory services (Active Directory)\n443   TCP    HTTPS           Encrypted web (TLS/SSL)\n514   UDP    Syslog          Centralized log collection\n636   TCP    LDAPS           LDAP over SSL/TLS\n993   TCP    IMAPS           IMAP over SSL/TLS\n995   TCP    POP3S           POP3 over SSL/TLS\n3389  TCP    RDP             Windows Remote Desktop</div>\n\n<h3>Monitoring Ports ‚Äî SNMP Explained</h3>\n<p><strong>SNMP 161 vs 162 confuses everyone.</strong> Here's the difference:</p>\n<div class=\"cli\"><span class=\"k\">Port 161 (SNMP polling):</span>\nYour monitoring server (Nagios, SolarWinds, PRTG) ASKS the\nrouter \"what's your CPU usage?\" every 5 minutes.\nDirection: Monitor ‚Üí Device (port 161)\n\n<span class=\"k\">Port 162 (SNMP traps):</span>\nSomething goes wrong on the router and it TELLS your\nmonitoring server \"hey, interface just went down!\"\nDirection: Device ‚Üí Monitor (port 162)\n\nOne is pull (161), the other is push (162).</div>\n\n<h3>Secure vs Insecure Protocols</h3>\n<div class=\"cli\"><span class=\"k\">Insecure          Secure Replacement</span>\nTelnet (23)    ‚Üí  SSH (22)\nHTTP (80)      ‚Üí  HTTPS (443)\nFTP (20/21)    ‚Üí  SFTP (22) or FTPS (990)\nSNMP v1/v2c    ‚Üí  SNMPv3 (auth + encryption)\nPOP3 (110)     ‚Üí  POP3S (995)\nIMAP (143)     ‚Üí  IMAPS (993)\nLDAP (389)     ‚Üí  LDAPS (636)</div>\n\n<div class=\"wb\">‚ö†Ô∏è <strong>Telnet sends passwords in PLAINTEXT.</strong> Anyone with a packet sniffer on the network can see every keystroke, including your enable password. Always use SSH.</div>", "questions": [{"type": "choice", "q": "HTTPS port?", "options": ["80", "443", "8080", "8443"], "answer": 1, "explain": "HTTPS=443."}, {"type": "choice", "q": "SNMP polling port?", "options": ["161", "162", "514", "389"], "answer": 0, "explain": "SNMP=161, traps=162."}, {"type": "choice", "q": "Syslog port?", "options": ["161", "389", "514", "993"], "answer": 2, "explain": "Syslog=514 UDP."}, {"type": "choice", "q": "RDP port?", "options": ["443", "1433", "3306", "3389"], "answer": 3, "explain": "RDP=3389 TCP."}, {"type": "choice", "q": "LDAP port?", "options": ["143", "389", "443", "636"], "answer": 1, "explain": "LDAP=389, LDAPS=636."}, {"type": "choice", "q": "Why Telnet is dangerous?", "options": ["Slow", "Plaintext including passwords", "High bandwidth", "Deprecated syntax"], "answer": 1, "explain": "Everything visible to sniffers."}]}, {"title": "TCP/IP Model", "content": "<h3>The TCP/IP Model vs OSI</h3>\n<p>The OSI model is the <strong>teaching framework</strong> (7 layers). The TCP/IP model is what the <strong>internet actually runs on</strong> (4 layers). They map to each other, but TCP/IP combines some OSI layers.</p>\n\n<div class=\"cli\"><span class=\"k\">TCP/IP (4 layers)         OSI Equivalent (7 layers)</span>\nApplication               7 Application + 6 Presentation + 5 Session\nTransport                 4 Transport\nInternet                  3 Network\nNetwork Access            2 Data Link + 1 Physical</div>\n\n<h3>What Lives at Each TCP/IP Layer</h3>\n<div class=\"cli\"><span class=\"k\">Application Layer:</span>\n  HTTP, HTTPS, FTP, SSH, Telnet, DNS, DHCP, SMTP, SNMP\n  Anything the user or application directly interacts with.\n  This combines OSI layers 5-7 because in practice they\n  work together and aren't clearly separated.\n\n<span class=\"k\">Transport Layer:</span>\n  TCP (reliable, connection-oriented)\n  UDP (fast, connectionless)\n  Handles port numbers, segmentation, flow control.\n\n<span class=\"k\">Internet Layer:</span>\n  IP (addressing + routing)\n  ICMP (ping, traceroute, error messages)\n  ARP (IP ‚Üí MAC resolution)\n  IGMP (multicast group management)\n\n<span class=\"k\">Network Access Layer:</span>\n  Ethernet (802.3), WiFi (802.11), PPP\n  MAC addressing, frame construction, physical signaling.\n  Everything needed to get bits across a single link.</div>\n\n<p><strong>ARP is special:</strong> ARP resolves IP addresses to MAC addresses. When your PC wants to reach 192.168.1.1, it broadcasts \"Who has 192.168.1.1? Tell me your MAC address.\" The device responds with its MAC, and your PC can build the Ethernet frame.</p>\n\n<div class=\"kp\">üí° <strong>Exam tip:</strong> If asked \"how many layers in TCP/IP?\" the answer is 4. If asked to \"map TCP/IP to OSI,\" know that the Application layer covers OSI 5+6+7 and Network Access covers OSI 1+2.</div>", "questions": [{"type": "choice", "q": "TCP/IP layers?", "options": ["3", "4", "5", "7"], "answer": 1, "explain": "4: App, Transport, Internet, Network Access."}, {"type": "choice", "q": "ICMP = which TCP/IP layer?", "options": ["Application", "Transport", "Internet", "Network Access"], "answer": 2, "explain": "Internet layer with IP."}, {"type": "choice", "q": "ARP maps?", "options": ["Hostname>IP", "IP>MAC", "MAC>IP", "Port>service"], "answer": 1, "explain": "ARP resolves IP to MAC."}]}]}];

const ACHV=[
{id:"fl",n:"First Steps",d:"Complete your first lesson",i:"\u{1F476}",ck:s=>s.lc>=1},
{id:"f5",n:"Getting Serious",d:"Complete 5 lessons",i:"\u{1F4DA}",ck:s=>s.lc>=5},
{id:"f10",n:"Dedicated Student",d:"Complete 10 lessons",i:"\u{1F393}",ck:s=>s.lc>=10},
{id:"s5",n:"On Fire",d:"5-answer streak",i:"\u{1F525}",ck:s=>s.bs>=5},
{id:"s10",n:"Unstoppable",d:"10-answer streak",i:"\u26A1",ck:s=>s.bs>=10},
{id:"s20",n:"Legendary",d:"20-answer streak",i:"\u{1F48E}",ck:s=>s.bs>=20},
{id:"t1",n:"Bug Hunter",d:"Solve a troubleshooting scenario",i:"\u{1F50D}",ck:s=>s.ss>=1},
{id:"ta",n:"Master Debugger",d:"Solve all scenarios",i:"\u{1F527}",ck:s=>s.ss>=5},
{id:"l5",n:"Rising Star",d:"Reach Level 5",i:"\u2B50",ck:s=>s.lv>=5},
{id:"l10",n:"Seasoned Pro",d:"Reach Level 10",i:"\u{1F31F}",ck:s=>s.lv>=10},
{id:"l20",n:"Network Sage",d:"Reach Level 20",i:"\u{1F9D9}",ck:s=>s.lv>=20},
{id:"pf",n:"Perfectionist",d:"100% on any quiz",i:"\u{1F4AF}",ck:s=>s.pq>=1}
];
const RANKS=[{l:1,n:"Cable Monkey",i:"\u{1F412}"},{l:3,n:"Packet Pusher",i:"\u{1F4E6}"},{l:5,n:"Wire Puller",i:"\u{1F50C}"},{l:8,n:"Port Sailor",i:"\u2693"},{l:11,n:"VLAN Viking",i:"\u{1F6E1}\uFE0F"},{l:14,n:"Subnet Soldier",i:"\u{1F396}\uFE0F"},{l:18,n:"Route Commander",i:"\u{1F9ED}"},{l:22,n:"Protocol Captain",i:"\u{1F468}\u200D\u2708\uFE0F"},{l:27,n:"ACL Enforcer",i:"\u{1F6A7}"},{l:32,n:"Firewall Marshal",i:"\u{1F525}"},{l:37,n:"Tunnel Master",i:"\u{1F6A7}"},{l:42,n:"Network Admiral",i:"\u2B50"},{l:48,n:"Cisco Overlord",i:"\u{1F451}"},{l:55,n:"CCIE Grandmaster",i:"\u{1F48E}"},{l:65,n:"Legendary Architect",i:"\u{1F3DB}\uFE0F"}];

function $(id){return document.getElementById(id)}
function getRank(l){let r=RANKS[0];for(const x of RANKS)if(l>=x.l)r=x;return r}
function xpFor(l){return Math.floor(80*Math.pow(1.18,l-1))}
function getTL(){let t=0;MODULES.forEach(m=>t+=m.lessons.length);return t}

const SK="cisco_cli_v3";
let S={started:false,lv:1,xp:0,str:0,bs:0,lc:0,ac:0,at:0,ss:0,pq:0,tc:0,ta:0,mp:{},ld:{},sd:{},cm:{},av:[]};
let qS={},aS={},tS={in:false,idx:0,ans:false};

function load(){try{const d=localStorage.getItem(SK);if(d){Object.assign(S,JSON.parse(d));return true}}catch(e){}return false}
function save(){try{localStorage.setItem(SK,JSON.stringify(S))}catch(e){}}

function addXP(a,x,y){
  S.xp+=a;
  if(x!==undefined){const e=document.createElement("div");e.className="xp-float";e.textContent="+"+a+" XP";e.style.left=x+"px";e.style.top=y+"px";document.body.appendChild(e);setTimeout(()=>e.remove(),1500)}
  while(S.xp>=xpFor(S.lv)){S.xp-=xpFor(S.lv);S.lv++;showLU()}
  updateTB();save();
}
function showLU(){
  const r=getRank(S.lv),pr=getRank(S.lv-1);
  let h=`<p style="font-size:18px;margin:8px 0">Level <span style="color:var(--cy);font-family:Orbitron;font-weight:700">${S.lv}</span></p>`;
  if(r.n!==pr.n)h+=`<div style="color:var(--gd);font-family:Orbitron;font-size:16px;margin:8px 0">${r.i} ${r.n.toUpperCase()}</div>`;
  $("lmc").innerHTML=h;$("lm").classList.remove("hidden");
}
function checkAch(){ACHV.forEach(a=>{if(!S.av.includes(a.id)&&a.ck(S)){S.av.push(a.id);showAT(a)}});save()}
function showAT(a){
  const t=document.createElement("div");
  t.style.cssText="position:fixed;bottom:24px;right:24px;background:var(--bg2);border:1px solid var(--gd);border-radius:12px;padding:16px 24px;display:flex;align-items:center;gap:12px;z-index:600;animation:slideUp .4s;box-shadow:0 8px 32px rgba(255,193,7,.2)";
  t.innerHTML=`<span style="font-size:32px">${a.i}</span><div><div style="font-size:10px;color:var(--gd);text-transform:uppercase;letter-spacing:2px;font-family:Orbitron">Achievement Unlocked!</div><div style="font-size:15px;font-weight:600;margin-top:4px">${a.n}</div><div style="font-size:12px;color:var(--txd)">${a.d}</div></div>`;
  document.body.appendChild(t);setTimeout(()=>{t.style.opacity="0";t.style.transition="opacity .5s";setTimeout(()=>t.remove(),500)},4000);
}
function updateTB(){
  const r=getRank(S.lv);$("rb").textContent=r.i+" "+r.n.toUpperCase();$("ld").textContent=S.lv;$("xd").textContent=S.xp;
  const n=xpFor(S.lv);$("xn").textContent=n;$("xb").style.width=(S.xp/n*100)+"%";
  $("sd").textContent=S.str+(S.str>=3?"\u{1F525}":"");$("md").textContent=Object.values(S.cm||{}).filter(v=>v>=3).length;
}

function showScreen(name){
  document.querySelectorAll(".screen").forEach(s=>s.classList.remove("active"));
  document.querySelectorAll(".nav-tab").forEach(t=>t.classList.remove("active"));
  const sc=$("s-"+name);if(sc)sc.classList.add("active");
  const tb=document.querySelector(`.nav-tab[data-screen="${name}"]`);if(tb)tb.classList.add("active");
  ({dashboard:renderDash,campaign:renderCamp,reference:renderRef,achievements:renderAchiev,settings:renderSet})[name]?.();
}

function renderDash(){
  const tl=getTL(),pct=tl>0?Math.round(S.lc/tl*100):0,acc=S.ta>0?Math.round(S.tc/S.ta*100):0,r=getRank(S.lv),mas=Object.values(S.cm||{}).filter(v=>v>=3).length;
  let nm=null;for(const m of MODULES){if((S.mp[m.id]||0)<m.lessons.length){nm=m;break}}
  $("s-dashboard").innerHTML=`<div class="dg"><div class="dc"><h3>Campaign</h3><div class="bn" style="color:var(--cy)">${pct}%</div><div class="st">${S.lc}/${tl} lessons</div><div style="margin-top:12px;height:8px;background:var(--bg);border-radius:4px;overflow:hidden"><div style="height:100%;width:${pct}%;background:linear-gradient(90deg,var(--cy),var(--gn));border-radius:4px"></div></div></div><div class="dc"><h3>Rank</h3><div class="bn" style="color:var(--gd)">${r.i}</div><div class="st">${r.n} \u2014 Lv.${S.lv}</div></div><div class="dc"><h3>Accuracy</h3><div class="bn" style="color:${acc>=70?'var(--gn)':acc>=40?'var(--or)':'var(--rd)'}">${acc}%</div><div class="st">${S.tc}/${S.ta} correct</div></div><div class="dc"><h3>Best Streak</h3><div class="bn" style="color:var(--or)">${S.bs}\u{1F525}</div><div class="st">Current: ${S.str}</div></div><div class="dc"><h3>Commands</h3><div class="bn" style="color:var(--pu)">${mas}</div><div class="st">of ${CMD_REF.length} mastered</div></div><div class="dc"><h3>Achievements</h3><div class="bn" style="color:var(--gd)">${S.av.length}</div><div class="st">of ${ACHV.length} unlocked</div></div>${nm?`<div class="dc fw" style="border-color:var(--cy2);cursor:pointer" onclick="showScreen('campaign')"><h3>Continue Training</h3><div style="display:flex;align-items:center;gap:16px"><span style="font-size:36px">${nm.icon}</span><div><div style="font-size:18px;font-weight:600">${nm.title}</div><div class="st">${nm.desc}</div></div><button class="btn bp" style="margin-left:auto">Resume \u2192</button></div></div>`:`<div class="dc fw" style="border-color:var(--gn)"><h3 style="color:var(--gn)">\u{1F3C6} Campaign Complete!</h3><div class="st">All modules mastered. Review any time in Campaign.</div></div>`}</div>`;
}

function renderCamp(){
  let h='<h2 style="font-family:Orbitron;font-size:22px;margin-bottom:20px">\u{1F4E1} Training Campaign</h2><div style="display:flex;gap:8px;margin-bottom:16px;flex-wrap:wrap"><span style="background:rgba(0,229,255,.15);color:var(--cy);padding:4px 12px;border-radius:4px;font-size:11px;font-family:Orbitron">BEGINNER</span><span style="background:rgba(0,255,136,.15);color:var(--gn);padding:4px 12px;border-radius:4px;font-size:11px;font-family:Orbitron">INTERMEDIATE</span><span style="background:rgba(255,145,0,.15);color:var(--or);padding:4px 12px;border-radius:4px;font-size:11px;font-family:Orbitron">ADVANCED</span><span style="background:rgba(255,61,61,.15);color:var(--rd);padding:4px 12px;border-radius:4px;font-size:11px;font-family:Orbitron">ADMIN</span></div>';
  MODULES.forEach((m,i)=>{const p=S.mp[m.id]||0,t=m.lessons.length,done=p>=t,prev=i===0||(S.mp[MODULES[i-1].id]||0)>=MODULES[i-1].lessons.length,locked=!prev&&!done&&p===0,cur=prev&&!done,cls=done?"completed":cur?"current":locked?"locked":"";
  const tier=m.tier||"Beginner";const tc={"Beginner":"var(--cy)","Intermediate":"var(--gn)","Advanced":"var(--or)","Admin":"var(--rd)"}[tier]||"var(--cy)";
  h+=`<div class="mc ${cls}" style="border-right:3px solid ${tc}" onclick="${locked?'':`startMod('${m.id}')`}"><div class="mn">${done?'\u2713':i+1}</div><div style="flex:1"><div style="font-family:Orbitron;font-size:15px;font-weight:600">${m.icon} ${m.title}</div><div style="font-size:13px;color:var(--txd)">${m.desc}</div></div><div style="width:120px;height:6px;background:var(--bg);border-radius:3px;overflow:hidden"><div style="height:100%;width:${p/t*100}%;background:linear-gradient(90deg,var(--cy),var(--gn));border-radius:3px"></div></div><span style="font-family:'JetBrains Mono';font-size:12px;color:var(--txd);min-width:40px;text-align:right">${p}/${t}</span></div>`});
  $("s-campaign").innerHTML=h;
}

function startMod(id){const m=MODULES.find(x=>x.id===id);if(!m)return;startLesson(id,Math.min(S.mp[id]||0,m.lessons.length-1))}

function startLesson(mid,li){qS={mid,li,phase:"learn",qi:0,cor:0,tot:0,ans:false};renderLesson();document.querySelectorAll(".screen").forEach(s=>s.classList.remove("active"));$("s-lesson").classList.add("active")}

function renderLesson(){
  const m=MODULES.find(x=>x.id===qS.mid),l=m.lessons[qS.li],sc=$("s-lesson");
  if(qS.phase==="learn"){sc.innerHTML=`<div style="max-width:900px;margin:0 auto" class="asu"><div class="lh"><div style="display:flex;align-items:center;gap:12px"><button class="btn bsm bs" onclick="showScreen('campaign')">\u2190 Back</button><div><h2>${m.icon} ${l.title}</h2><div style="font-size:13px;color:var(--txd)">${m.title} \u2014 Lesson ${qS.li+1}/${m.lessons.length}</div></div></div></div><div class="lcnt">${l.content}</div><div style="display:flex;justify-content:space-between;margin-top:20px">${qS.li>0?`<button class="btn bs" onclick="startLesson('${qS.mid}',${qS.li-1})">\u2190 Prev</button>`:'<div></div>'}<button class="btn bp blg" onclick="startQuiz()">\u26A1 Test Knowledge \u2192</button></div></div>`}
  else if(qS.phase==="quiz"){renderQQ()}else{renderLC()}
}
function startQuiz(){qS.phase="quiz";qS.qi=0;qS.cor=0;qS.tot=0;qS.ans=false;renderQQ()}

function renderQQ(){
  const m=MODULES.find(x=>x.id===qS.mid),l=m.lessons[qS.li],q=l.questions[qS.qi],sc=$("s-lesson");
  if(!q){compQuiz();return}const K=["A","B","C","D"];let inp;
  if(q.type==="type"){inp=`<div style="background:var(--bg3);border:1px solid var(--br);border-radius:10px;padding:24px;margin-top:16px"><p style="margin-bottom:12px">${q.q}</p><div class="tiw"><span class="tip">${q.prompt||'Router#'}</span><input type="text" class="tii" id="ta" placeholder="Type command..." autofocus onkeydown="if(event.key==='Enter')chkType()"></div><div id="tf" style="margin-top:12px"></div><button class="btn bp" style="margin-top:12px" onclick="chkType()" id="tsb">Submit</button></div>`}
  else{inp=`<div class="qo" id="qo">${q.options.map((o,i)=>`<div class="qopt" onclick="chkAns(${i},event)" data-idx="${i}"><div class="ok">${K[i]}</div><div>${o}</div></div>`).join('')}</div><div id="qf" style="margin-top:16px"></div>`}
  sc.innerHTML=`<div style="max-width:900px;margin:0 auto" class="afi"><div class="lh"><div style="display:flex;justify-content:space-between;align-items:center"><h2>\u{1F4DD} Knowledge Check</h2><div style="font-family:Orbitron;font-size:14px;padding:6px 16px;border-radius:20px;background:var(--bg3);border:1px solid var(--or);color:var(--or);${S.str>=5?'animation:streakFire 1s infinite':''}">${S.str}\u{1F525}</div></div><div style="display:flex;align-items:center;gap:12px;margin-top:12px"><div class="lpb"><div class="lpf" style="width:${qS.qi/l.questions.length*100}%"></div></div><span style="font-family:'JetBrains Mono';font-size:12px;color:var(--txd)">${qS.qi+1}/${l.questions.length}</span></div></div><div style="background:var(--bg3);border:1px solid var(--br);border-radius:10px;padding:32px;margin-bottom:20px;text-align:center"><div style="font-size:11px;color:var(--pu);text-transform:uppercase;letter-spacing:2px;margin-bottom:16px;font-family:'JetBrains Mono'">${q.type==='type'?'\u2328\uFE0F TYPE-IN':'\u{1F3AF} MULTIPLE CHOICE'}</div><div style="font-size:17px;line-height:1.6">${q.q}</div></div>${inp}</div>`;
  if(q.type==="type")setTimeout(()=>$("ta")?.focus(),100);
}

function fb(cor,exp){return `<div style="padding:16px;background:${cor?'rgba(0,255,136,.1)':'rgba(255,61,61,.1)'};border-radius:8px;border:1px solid ${cor?'var(--gn)':'var(--rd)'}"><strong style="color:${cor?'var(--gn)':'var(--rd)'}">${cor?'\u2705 Correct!':'\u274C Not quite.'}</strong><p style="margin-top:8px;font-size:14px;color:var(--txd)">${exp||''}</p></div><button class="btn bp" style="margin-top:12px" onclick="nextQ()">Continue \u2192</button>`}

function chkAns(idx,ev){
  if(qS.ans)return;qS.ans=true;qS.tot++;S.ta++;
  const m=MODULES.find(x=>x.id===qS.mid),l=m.lessons[qS.li],q=l.questions[qS.qi],cor=idx===q.answer;
  document.querySelectorAll(".qopt").forEach((o,i)=>{o.classList.add("disabled");if(i===q.answer)o.classList.add("correct");if(i===idx&&!cor)o.classList.add("wrong")});
  if(cor){qS.cor++;S.tc++;S.str++;if(S.str>S.bs)S.bs=S.str;const r=ev?.target?.getBoundingClientRect();addXP(15+Math.min(S.str*2,20),r?.x||400,r?.y||300)}else{S.str=0}
  $("qf").innerHTML=fb(cor,q.explain);updateTB();checkAch();
}

function chkType(){
  if(qS.ans)return;const inp=$("ta"),uv=inp.value.trim().toLowerCase();if(!uv)return;
  qS.ans=true;qS.tot++;S.ta++;
  const m=MODULES.find(x=>x.id===qS.mid),l=m.lessons[qS.li],q=l.questions[qS.qi];
  const ans=q.answer.map(a=>a.toLowerCase().trim()),cor=ans.some(a=>uv===a||uv.replace(/\s+/g,' ')===a.replace(/\s+/g,' '));
  if(cor){qS.cor++;S.tc++;S.str++;if(S.str>S.bs)S.bs=S.str;addXP(25+Math.min(S.str*3,30),400,300)}else{S.str=0}
  inp.disabled=true;inp.style.color=cor?"var(--gn)":"var(--rd)";$("tsb").style.display="none";
  let ex=q.explain||'';if(!cor)ex=`Accepted: <code style="color:var(--gn)">${q.answer.join('</code> or <code style="color:var(--gn)">')}</code>`;
  $("tf").innerHTML=fb(cor,ex);updateTB();checkAch();
}

function nextQ(){qS.qi++;qS.ans=false;const m=MODULES.find(x=>x.id===qS.mid),l=m.lessons[qS.li];if(qS.qi>=l.questions.length)compQuiz();else renderQQ()}

function compQuiz(){
  const k=`${qS.mid}_${qS.li}`,isNew=!S.ld[k];
  if(isNew){S.ld[k]=true;S.lc++;S.mp[qS.mid]=(S.mp[qS.mid]||0)+1;addXP(50)}
  const pct=qS.tot>0?Math.round(qS.cor/qS.tot*100):100;
  if(pct===100&&qS.tot>0){S.pq=(S.pq||0)+1;addXP(50)}
  qS.phase="complete";save();checkAch();renderLC();
}

function renderLC(){
  const m=MODULES.find(x=>x.id===qS.mid),pct=qS.tot>0?Math.round(qS.cor/qS.tot*100):100,hasN=qS.li<m.lessons.length-1;
  const bc=pct>=80?'var(--gn)':pct>=50?'var(--or)':'var(--rd)';
  $("s-lesson").innerHTML=`<div class="rp asu"><h2 style="font-family:Orbitron;font-size:24px;margin-bottom:8px">Lesson Complete!</h2><p style="color:var(--txd)">${m.lessons[qS.li].title}</p><div class="scr" style="border:3px solid ${bc}"><div class="pc" style="color:${bc}">${pct}%</div><div class="lb">SCORE</div></div><div class="sr"><div class="si"><div class="va" style="color:var(--gn)">${qS.cor}</div><div class="la">Correct</div></div><div class="si"><div class="va" style="color:var(--rd)">${qS.tot-qS.cor}</div><div class="la">Wrong</div></div><div class="si"><div class="va" style="color:var(--or)">${S.str}\u{1F525}</div><div class="la">Streak</div></div></div>${pct===100?'<p style="color:var(--gd);font-family:Orbitron;font-size:14px;margin:12px 0">\u{1F4AF} PERFECT! +50 Bonus XP</p>':''}<div style="display:flex;gap:12px;justify-content:center;margin-top:24px;flex-wrap:wrap"><button class="btn bs" onclick="startLesson('${qS.mid}',${qS.li})">\u{1F504} Review</button>${hasN?`<button class="btn bp blg" onclick="startLesson('${qS.mid}',${qS.li+1})">Next Lesson \u2192</button>`:`<button class="btn bg blg" onclick="showScreen('campaign')">\u{1F3C6} Back to Campaign</button>`}</div></div>`;
}

// REFERENCE
const CC={'Navigation':'#00e5ff','Setup':'#b388ff','Security':'#ff3d3d','Show':'#00ff88','FileMgmt':'#ffd740','Interfaces':'#ff9100','VLANs':'#00bcd4','Routing':'#e040fb','OSPF':'#7c4dff','ACLs':'#ff5252','NAT':'#ffab40','Services':'#69f0ae','Troubleshoot':'#ffd740'};
function rCards(cmds){return cmds.map(c=>{const m=S.cm[c.c]||0,cl=CC[c.t]||'#888';return`<div class="rc"><div class="rcm">${c.c}</div><div class="rcd">${c.d}</div><div style="display:flex;justify-content:space-between;align-items:center;margin-top:8px"><span class="rcat" style="background:${cl}22;color:${cl};border:1px solid ${cl}44">${c.t}</span><div class="md2">${[1,2,3].map(i=>`<div class="mdd ${m>=i?'f':''}"></div>`).join('')}</div></div></div>`}).join('')}
let rcf='all';
function renderRef(){
  const cats=[...new Set(CMD_REF.map(c=>c.t))];
  $("s-reference").innerHTML=`<div class="asu"><h2 style="font-family:Orbitron;font-size:22px;margin-bottom:20px">\u{1F4D6} Command Reference</h2><div class="rfs"><input type="text" class="rfi" placeholder="\u{1F50D} Search commands..." oninput="fRef()" id="rsi"><div style="display:flex;gap:6px;flex-wrap:wrap"><button class="rfb active" onclick="fCat('all',this)">All</button>${cats.map(c=>`<button class="rfb" onclick="fCat('${c}',this)">${c}</button>`).join('')}</div></div><div class="rsg" id="rg">${rCards(CMD_REF)}</div></div>`;
}
function fCat(c,b){rcf=c;document.querySelectorAll('.rfb').forEach(x=>x.classList.remove('active'));b.classList.add('active');fRef()}
function fRef(){const t=($("rsi")?.value||'').toLowerCase();let f=CMD_REF;if(rcf!=='all')f=f.filter(c=>c.t===rcf);if(t)f=f.filter(c=>c.c.toLowerCase().includes(t)||c.d.toLowerCase().includes(t));$("rg").innerHTML=rCards(f)}

// ACHIEVEMENTS
function renderAchiev(){$("s-achievements").innerHTML=`<div class="asu"><h2 style="font-family:Orbitron;font-size:22px;margin-bottom:8px">\u{1F3C6} Achievements</h2><p style="color:var(--txd);margin-bottom:24px">${S.av.length}/${ACHV.length} unlocked</p><div class="ag">${ACHV.map(a=>{const e=S.av.includes(a.id);return`<div class="ac ${e?'earned':'locked'}"><div class="ai2">${a.i}</div><div><h4 style="font-size:14px;font-weight:600;margin-bottom:4px">${a.n}</h4><p style="font-size:12px;color:var(--txd)">${a.d}</p>${e?'<span style="font-size:11px;color:var(--gd)">\u2705 Unlocked</span>':'<span style="font-size:11px;color:var(--txd)">\u{1F512} Locked</span>'}</div></div>`}).join('')}</div></div>`}

// SETTINGS
function renderSet(){const r=getRank(S.lv);$("s-settings").innerHTML=`<div style="max-width:600px;margin:0 auto" class="asu"><h2 style="font-family:Orbitron;font-size:22px;margin-bottom:20px">\u2699\uFE0F Settings</h2><div class="ss"><h3>Profile</h3><p style="margin-bottom:8px">Rank: ${r.i} ${r.n}</p><p style="margin-bottom:8px">Level: ${S.lv}</p><p>Lessons: ${S.lc}/${getTL()}</p></div><div class="ss"><h3>Data</h3><p style="font-size:13px;color:var(--txd);margin-bottom:16px">Progress saves automatically.</p><button class="btn bd" onclick="if(confirm('\u26A0\uFE0F Delete ALL progress?')){localStorage.removeItem('${SK}');location.reload()}">\u{1F5D1}\uFE0F Reset</button></div><div class="ss"><h3>About</h3><p style="font-size:13px;color:var(--txd)">Cisco CLI Academy \u2014 Command Line Combat Training. Covers IOS navigation, device setup, VLANs, routing, OSPF, ACLs, NAT, security, troubleshooting. Open this file anytime to continue.</p></div><button class="btn bs" onclick="showScreen('dashboard')" style="margin-top:12px">\u2190 Back</button></div>`}

// KEYBOARD
document.addEventListener('keydown',e=>{if(e.target.tagName==='INPUT')return;const k=e.key.toUpperCase();if(['A','B','C','D'].includes(k)){const i=k.charCodeAt(0)-65;const o=document.querySelector(`.qopt[data-idx="${i}"]`);if(o&&!o.classList.contains('disabled'))o.click()}if(e.key==='Enter'){const b=document.querySelector('#qf .btn,#af .btn,#sf .btn,#tf .btn');if(b)b.click()}});

// INIT
function startNewGame(){S.started=true;save();$("ws").style.display="none";$("ma").style.display="block";updateTB();showScreen("dashboard")}
function init(){load();if(S.started){$("ws").style.display="none";$("ma").style.display="block";updateTB();showScreen("dashboard")}else{$("ws").style.display="flex";$("ma").style.display="none"}}
init();
</script></body></html>